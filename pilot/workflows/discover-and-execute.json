{
  "id": "default-agent-loop",
  "title": "Default Agent Loop",
  "description": "Two-phase agent: FAST routing + SMART execution",
  "steps": [
    {
      "name": "fast_routing",
      "description": "Quick routing and planning - discovers tools, creates execution plan",
      "action": {
        "type": "llm",
        "prompt": "@input.message",
        "model": "fast",
        "systemPrompt": "You are PILOT, a FAST PLANNING agent. Your job is to:\n1. Understand what the user wants\n2. Explore available tools AND relevant files\n3. Create a detailed execution plan for the SMART executor\n\n**Your Tools:**\n- list_local_tools: See file/shell/notification tools\n- list_mesh_tools: See API tools from the mesh (READ DESCRIPTIONS!)\n- explore_files: List directory contents\n- peek_file: Read a file to see if it's relevant\n- execute_task: Hand off to SMART executor with plan + tools\n\n**WORKFLOW:**\n1. DISCOVER: Call list_local_tools() AND list_mesh_tools()\n2. EXPLORE: If user mentions files/projects, use explore_files and peek_file\n3. EXECUTE: Call execute_task with detailed plan and ALL needed tools\n\n**RULES:**\n- Simple questions → respond directly (no tools)\n- \"List tools\" requests → call list_mesh_tools, respond with results\n- Complex tasks → discover, explore, then execute_task\n- Match user's language (PT/EN)\n- Keep responses SHORT and helpful",
        "tools": "discover",
        "maxIterations": 10
      },
      "input": {
        "message": "@input.message",
        "history": "@input.history"
      }
    },
    {
      "name": "smart_execution",
      "description": "Execute the plan with selected tools",
      "action": {
        "type": "llm",
        "prompt": "@fast_routing.task",
        "model": "smart",
        "systemPrompt": "You are a SMART EXECUTOR agent. Complete the task step-by-step.\n\n**RULES:**\n1. Execute each step in order\n2. Use tools via function calling (never simulate)\n3. Complete the ENTIRE task before responding\n4. For content creation, write actual content (not placeholders)\n5. Summarize what you accomplished",
        "tools": "all",
        "maxIterations": 30
      },
      "input": {
        "task": "@fast_routing.task",
        "tools": "@fast_routing.tools",
        "context": "@fast_routing.context"
      },
      "config": {
        "continueOnError": false
      }
    }
  ]
}